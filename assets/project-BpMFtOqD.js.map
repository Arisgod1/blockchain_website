{"version":3,"file":"project-BpMFtOqD.js","sources":["../../src/api/project.ts"],"sourcesContent":["import apiService from '@/api/client'\r\nimport type { Project } from '@/types/entities'\r\nimport { ensurePagedData, type PaginationParams, type PageResult, type QueryParams } from '@/api/utils'\r\n\r\nexport type PageProject = PageResult<Project>\r\n\r\n// 获取分页项目列表\r\nexport const getProjects = async (params?: PaginationParams & Record<string, unknown>): Promise<PageProject> => {\r\n  const res = await apiService.get<PageProject | Project[]>('/api/projects', { params })\r\n  if (!res.success) throw new Error(res.message || '获取项目列表失败')\r\n  return ensurePagedData<Project>(res.data, params)\r\n}\r\n\r\n// 根据 ID 获取单个项目\r\nexport const getProject = async (id: string | number): Promise<Project | null> => {\r\n  const res = await apiService.get<Project>(`/api/projects/${id}`)\r\n  if (!res.success) throw new Error(res.message || '获取项目失败')\r\n  return res.data ?? null\r\n}\r\n\r\n// 创建新项目\r\nexport const createProject = async (payload: Partial<Project>): Promise<Project> => {\r\n  const res = await apiService.post<Project>('/api/projects', payload)\r\n  if (!res.success) throw new Error(res.message || '创建项目失败')\r\n  if (!res.data) throw new Error('创建项目未返回数据')\r\n  return res.data\r\n}\r\n\r\n// 更新项目（PUT）\r\nexport const updateProject = async (id: string | number, payload: Partial<Project>): Promise<Project> => {\r\n  const res = await apiService.put<Project>(`/api/projects/${id}`, payload)\r\n  if (!res.success) throw new Error(res.message || '更新项目失败')\r\n  if (!res.data) throw new Error('更新项目未返回数据')\r\n  return res.data\r\n}\r\n\r\n// 删除项目\r\nexport const deleteProject = async (id: string | number): Promise<void> => {\r\n  const res = await apiService.delete<void>(`/api/projects/${id}`)\r\n  if (!res.success) throw new Error(res.message || '删除项目失败')\r\n  return\r\n}\r\n\r\n// 根据状态获取项目列表（不分页）\r\nexport const getProjectsByStatus = async (status: string): Promise<Project[]> => {\r\n  const res = await apiService.get<Project[]>(`/api/projects/status/${status}`)\r\n  if (!res.success) throw new Error(res.message || '根据状态获取项目失败')\r\n  return res.data ?? []\r\n}\r\n\r\n// 搜索项目\r\nexport const searchProjects = async (params?: QueryParams): Promise<Project[]> => {\r\n  const res = await apiService.get<Project[]>('/api/projects/search', { params })\r\n  if (!res.success) throw new Error(res.message || '搜索项目失败')\r\n  return res.data ?? []\r\n}\r\n\r\n// PATCH 更新项目状态\r\nexport const patchProjectStatus = async (id: string | number, status: string): Promise<Project> => {\r\n  const res = await apiService.patch<Project>(`/api/projects/${id}/status`, null, { params: { status } })\r\n  if (!res.success) throw new Error(res.message || '更新项目状态失败')\r\n  if (!res.data) throw new Error('更新项目状态未返回数据')\r\n  return res.data\r\n}\r\n\r\n// PATCH 更新项目进度\r\nexport const patchProjectProgress = async (id: string | number, progress: number): Promise<Project> => {\r\n  const res = await apiService.patch<Project>(`/api/projects/${id}/progress`, null, { params: { progress } })\r\n  if (!res.success) throw new Error(res.message || '更新项目进度失败')\r\n  if (!res.data) throw new Error('更新项目进度未返回数据')\r\n  return res.data\r\n}\r\n\r\n// PATCH 更新显示顺序（displayOrder）\r\nexport const patchProjectDisplayOrder = async (id: string | number, displayOrder: number): Promise<void> => {\r\n  const res = await apiService.patch<void>(`/api/projects/${id}/display-order`, null, { params: { displayOrder } })\r\n  if (!res.success) throw new Error(res.message || '更新显示顺序失败')\r\n  return\r\n}\r\n\r\nexport default {\r\n  getProjects,\r\n  getProject,\r\n  createProject,\r\n  updateProject,\r\n  deleteProject,\r\n  getProjectsByStatus,\r\n  searchProjects,\r\n  patchProjectStatus,\r\n  patchProjectProgress,\r\n  patchProjectDisplayOrder\r\n}"],"names":["getProjects","params","res","apiService","ensurePagedData","createProject","payload","updateProject","id","deleteProject"],"mappings":"gFAOO,MAAMA,EAAc,MAAOC,GAA8E,CAC9G,MAAMC,EAAM,MAAMC,EAAW,IAA6B,gBAAiB,CAAE,OAAAF,EAAQ,EACrF,GAAI,CAACC,EAAI,QAAS,MAAM,IAAI,MAAMA,EAAI,SAAW,UAAU,EAC3D,OAAOE,EAAyBF,EAAI,KAAMD,CAAM,CAClD,EAUaI,EAAgB,MAAOC,GAAgD,CAClF,MAAMJ,EAAM,MAAMC,EAAW,KAAc,gBAAiBG,CAAO,EACnE,GAAI,CAACJ,EAAI,QAAS,MAAM,IAAI,MAAMA,EAAI,SAAW,QAAQ,EACzD,GAAI,CAACA,EAAI,KAAM,MAAM,IAAI,MAAM,WAAW,EAC1C,OAAOA,EAAI,IACb,EAGaK,EAAgB,MAAOC,EAAqBF,IAAgD,CACvG,MAAMJ,EAAM,MAAMC,EAAW,IAAa,iBAAiBK,CAAE,GAAIF,CAAO,EACxE,GAAI,CAACJ,EAAI,QAAS,MAAM,IAAI,MAAMA,EAAI,SAAW,QAAQ,EACzD,GAAI,CAACA,EAAI,KAAM,MAAM,IAAI,MAAM,WAAW,EAC1C,OAAOA,EAAI,IACb,EAGaO,EAAgB,MAAOD,GAAuC,CACzE,MAAMN,EAAM,MAAMC,EAAW,OAAa,iBAAiBK,CAAE,EAAE,EAC/D,GAAI,CAACN,EAAI,QAAS,MAAM,IAAI,MAAMA,EAAI,SAAW,QAAQ,CAE3D"}