import{c as B,a as Z,o as tt,B as k,L as et,b as st,r as nt,_ as at}from"./index-8iE1hBqO.js";import{e as it}from"./utils-BZMi4_q3.js";import{B as b}from"./BaseCard-Cc5MeAo1.js";import{B as ot}from"./BasePagination-BEDg0lVz.js";import{_ as lt,a as rt}from"./ListIcon.vue_vue_type_script_setup_true_lang-CZxNQ0Ja.js";import{M as dt,a as ct,b as ut}from"./MeetingDetailModal-CTyaJ5JD.js";import{l as vt,r as h,j as C,a as N,k as gt,e as mt,C as v,E as s,z as i,B as l,N as $,u as o,K as f,F as R,Q as I,G as P,W as ft,J as g}from"./vendor-vue-KPUYMlG2.js";import"./vendor-utils-B9ygI19o.js";const pt=async m=>{const a=await B.get("/api/meetings",{params:m});if(!a.success)throw new Error(a.message||"è·å–ä¾‹ä¼šåˆ—è¡¨å¤±è´¥");return it(a.data,m)},wt=async m=>{const a=await B.post("/api/meetings",m);if(!a.success)throw new Error(a.message||"åˆ›å»ºä¾‹ä¼šå¤±è´¥");if(!a.data)throw new Error("åˆ›å»ºä¾‹ä¼šæœªè¿”å›æ•°æ®");return a.data},ht=async(m,a)=>{const p=await B.put(`/api/meetings/${m}`,a);if(!p.success)throw new Error(p.message||"æ›´æ–°ä¾‹ä¼šå¤±è´¥");if(!p.data)throw new Error("æ›´æ–°ä¾‹ä¼šæœªè¿”å›æ•°æ®");return p.data},_t=async m=>{const a=await B.delete(`/api/meetings/${m}`);if(!a.success)throw new Error(a.message||"åˆ é™¤ä¾‹ä¼šå¤±è´¥")},Ct={class:"admin-meeting-manager"},yt={class:"manager-header"},Mt={class:"header-actions"},kt={class:"filter-section"},bt={class:"stats-section"},$t={class:"stats-grid"},Dt={class:"stat-content"},Et={class:"stat-info"},Bt={class:"stat-number"},zt={class:"stat-content"},St={class:"stat-info"},Vt={class:"stat-number"},Ft={class:"stat-content"},xt={class:"stat-info"},At={class:"stat-number"},Lt={class:"stat-content"},Nt={class:"stat-info"},Rt={class:"stat-number"},It={class:"meetings-section"},Pt={class:"section-header"},Ut={class:"view-controls"},Ot={key:0,class:"loading-container"},Tt={key:1,class:"empty-state"},Wt={key:2},jt={key:0,class:"meetings-grid"},Gt={key:1,class:"meetings-list"},Ht={class:"meeting-list-content"},Jt={class:"meeting-main-info"},Kt={class:"meeting-meta"},Qt={class:"meta-item"},qt={class:"meta-item"},Xt={class:"meta-item"},Yt={class:"meeting-actions"},Zt=["onClick"],te=["onClick"],ee=["onClick"],se=["onClick"],ne={class:"pagination-section"},ae=vt({__name:"AdminMeetingManager",setup(m){Z({title:"ä¾‹ä¼šç®¡ç† - ç®¡ç†å‘˜åå°",meta:[{name:"description",content:"ç®¡ç†ä¾‹ä¼šè®°å½•ã€æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯"}]});const a=h([]),p=h(!1),y=h("grid"),D=h({search:"",status:"",sortBy:"date",sortOrder:"desc"}),d=h({current:1,pageSize:12,total:0}),E=h({show:!1,meeting:null}),c=h({show:!1,meeting:null,isCreate:!1}),u=h({show:!1,meeting:null,loading:!1}),U=C(()=>a.value),z=C(()=>a.value),S=[],w=(e,t,r="success",n)=>{nt({entity:"meetings",action:e,message:t,targetId:n,result:r}).catch(M=>{console.warn("è®°å½•ä¾‹ä¼šæ“ä½œæ—¥å¿—å¤±è´¥:",M)})};N(()=>d.value.current,()=>{_()}),N(()=>D.value,()=>{d.value.current=1,_()},{deep:!0});const O=C(()=>a.value.length),T=C(()=>{const e=new Date;return e.setDate(e.getDate()-7),a.value.filter(t=>new Date(t.date)>=e).length}),W=C(()=>a.value.reduce((e,t)=>e+t.attendees.length,0)),j=C(()=>a.value.reduce((e,t)=>{const r=t.actionItems??[];return e+r.filter(n=>n.status==="completed").length},0)),G=e=>new Date(e).toLocaleDateString("zh-CN"),_=async()=>{p.value=!0;try{const e=await pt({page:d.value.current-1,size:d.value.pageSize,keyword:D.value.search});a.value=e.content,d.value.total=e.totalElements}catch(e){console.error("åŠ è½½ä¾‹ä¼šæ•°æ®å¤±è´¥:",e)}finally{p.value=!1}},H=()=>{d.value.current=1},J=e=>{d.value.current=e},V=()=>{c.value={show:!0,meeting:null,isCreate:!0}},F=e=>{E.value={show:!0,meeting:e}},K=e=>{var r;const t=(r=e.files)==null?void 0:r[0];t!=null&&t.url&&window.open(t.url,"_blank")},Q=e=>{e.recording&&window.open(e.recording,"_blank")},x=e=>{c.value={show:!0,meeting:{...e},isCreate:!1}},A=e=>{u.value={show:!0,meeting:e,loading:!1}},L=e=>{const t={...e,id:Date.now().toString(),title:`${e.title} (å‰¯æœ¬)`,date:new Date().toISOString().split("T")[0]};a.value.unshift(t),w("duplicate",`å¤åˆ¶ä¾‹ä¼šã€Œ${e.title}ã€`,"success",e.id)},q=async e=>{try{if(c.value.isCreate){const t=await wt(e);w("create",`åˆ›å»ºä¾‹ä¼šã€Œ${t.title}ã€`,"success",t.id)}else{const t=await ht(e.id,e);w("update",`æ›´æ–°ä¾‹ä¼šã€Œ${t.title}ã€`,"success",t.id)}await _(),c.value.show=!1}catch(t){console.error("ä¿å­˜ä¾‹ä¼šå¤±è´¥:",t);const r=c.value.isCreate?"create":"update";w(r,`ä¿å­˜ä¾‹ä¼šã€Œ${e.title}ã€å¤±è´¥`,"failure",e.id)}},X=async()=>{const e=u.value.meeting;if(e){u.value.loading=!0;try{await _t(e.id),await _(),u.value.show=!1,w("delete",`åˆ é™¤ä¾‹ä¼šã€Œ${e.title}ã€`,"success",e.id)}catch(t){console.error("åˆ é™¤ä¾‹ä¼šå¤±è´¥:",t),w("delete",`åˆ é™¤ä¾‹ä¼šã€Œ${e.title}ã€å¤±è´¥`,"failure",e.id)}finally{u.value.loading=!1}}},Y=()=>{_(),w("refresh","æ‰‹åŠ¨åˆ·æ–°ä¾‹ä¼šåˆ—è¡¨")};return gt(()=>{_();const e=tt(t=>{if(t.entity==="all"||t.entity==="meetings"){_();const r=t.action??"refresh";w("refresh",`å…¨å±€è§¦å‘ ${r} åŒæ­¥ä¾‹ä¼šæ•°æ®`)}});S.push(e)}),mt(()=>{S.forEach(e=>e())}),(e,t)=>{const r=ft("MeetingEditModal");return g(),v("div",Ct,[s("div",yt,[t[10]||(t[10]=s("h2",null,"ä¾‹ä¼šç®¡ç†",-1)),s("div",Mt,[i(o(k),{variant:"primary",onClick:V},{default:l(()=>[...t[8]||(t[8]=[$(" + æ–°å»ºä¾‹ä¼š ",-1)])]),_:1}),i(o(k),{variant:"secondary",onClick:Y},{default:l(()=>[...t[9]||(t[9]=[$(" åˆ·æ–° ",-1)])]),_:1})])]),s("div",kt,[i(dt,{filters:D.value,"onUpdate:filters":t[0]||(t[0]=n=>D.value=n),onChange:H},null,8,["filters"])]),s("div",bt,[s("div",$t,[i(o(b),{class:"stat-card"},{default:l(()=>[s("div",Dt,[t[12]||(t[12]=s("div",{class:"stat-icon meeting-icon"}," ğŸ“… ",-1)),s("div",Et,[s("div",Bt,f(O.value),1),t[11]||(t[11]=s("div",{class:"stat-label"}," æ€»ä¾‹ä¼šæ•° ",-1))])])]),_:1}),i(o(b),{class:"stat-card"},{default:l(()=>[s("div",zt,[t[14]||(t[14]=s("div",{class:"stat-icon recent-icon"}," ğŸ†• ",-1)),s("div",St,[s("div",Vt,f(T.value),1),t[13]||(t[13]=s("div",{class:"stat-label"}," æœ¬å‘¨ä¾‹ä¼š ",-1))])])]),_:1}),i(o(b),{class:"stat-card"},{default:l(()=>[s("div",Ft,[t[16]||(t[16]=s("div",{class:"stat-icon participants-icon"}," ğŸ‘¥ ",-1)),s("div",xt,[s("div",At,f(W.value),1),t[15]||(t[15]=s("div",{class:"stat-label"}," å‚ä¸äººæ¬¡ ",-1))])])]),_:1}),i(o(b),{class:"stat-card"},{default:l(()=>[s("div",Lt,[t[18]||(t[18]=s("div",{class:"stat-icon action-icon"}," âœ… ",-1)),s("div",Nt,[s("div",Rt,f(j.value),1),t[17]||(t[17]=s("div",{class:"stat-label"}," å¾…åŠå®Œæˆ ",-1))])])]),_:1})])]),s("div",It,[i(o(b),{class:"content-card"},{header:l(()=>[s("div",Pt,[t[19]||(t[19]=s("h3",null,"ä¾‹ä¼šåˆ—è¡¨",-1)),s("div",Ut,[s("button",{class:P(["view-btn",{active:y.value==="grid"}]),onClick:t[1]||(t[1]=n=>y.value="grid")},[i(o(lt),{size:"16"})],2),s("button",{class:P(["view-btn",{active:y.value==="list"}]),onClick:t[2]||(t[2]=n=>y.value="list")},[i(o(rt),{size:"16"})],2)])])]),default:l(()=>[p.value?(g(),v("div",Ot,[i(o(et)),t[20]||(t[20]=s("p",null,"åŠ è½½ä¾‹ä¼šæ•°æ®ä¸­...",-1))])):U.value.length===0?(g(),v("div",Tt,[t[22]||(t[22]=s("div",{class:"empty-icon"}," ğŸ“… ",-1)),t[23]||(t[23]=s("h3",null,"æš‚æ— ä¾‹ä¼šè®°å½•",-1)),t[24]||(t[24]=s("p",null,"æ‚¨è¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•ä¾‹ä¼šè®°å½•",-1)),i(o(k),{variant:"primary",onClick:V},{default:l(()=>[...t[21]||(t[21]=[$(" åˆ›å»ºç¬¬ä¸€ä¸ªä¾‹ä¼š ",-1)])]),_:1})])):(g(),v("div",Wt,[y.value==="grid"?(g(),v("div",jt,[(g(!0),v(R,null,I(z.value,n=>(g(),v("div",{key:n.id,class:"meeting-grid-item"},[i(ut,{meeting:n,"show-actions":!0,onView:F,onEdit:x,onDelete:A,onDuplicate:L},null,8,["meeting"])]))),128))])):(g(),v("div",Gt,[(g(!0),v(R,null,I(z.value,n=>(g(),v("div",{key:n.id,class:"meeting-list-item"},[s("div",Ht,[s("div",Jt,[s("h4",null,f(n.title),1),s("div",Kt,[s("span",Qt," ğŸ“… "+f(G(n.date)),1),s("span",qt," ğŸ• "+f(n.time),1),s("span",Xt," ğŸ‘¥ "+f(n.attendees.length)+" äººå‚ä¸ ",1)])]),s("div",Yt,[s("button",{class:"action-btn view-btn",title:"æŸ¥çœ‹è¯¦æƒ…",onClick:M=>F(n)}," ğŸ‘ï¸ ",8,Zt),s("button",{class:"action-btn edit-btn",title:"ç¼–è¾‘",onClick:M=>x(n)}," âœï¸ ",8,te),s("button",{class:"action-btn duplicate-btn",title:"å¤åˆ¶",onClick:M=>L(n)}," ğŸ“‹ ",8,ee),s("button",{class:"action-btn delete-btn",title:"åˆ é™¤",onClick:M=>A(n)}," ğŸ—‘ï¸ ",8,se)])])]))),128))])),s("div",ne,[i(o(ot),{current:d.value.current,"page-size":d.value.pageSize,total:d.value.total,onChange:J},null,8,["current","page-size","total"])])]))]),_:1})]),i(ct,{meeting:E.value.meeting,"is-open":E.value.show,onClose:t[3]||(t[3]=n=>E.value.show=!1),onViewFiles:K,onViewRecording:Q},null,8,["meeting","is-open"]),i(r,{show:c.value.show,"onUpdate:show":t[4]||(t[4]=n=>c.value.show=n),meeting:c.value.meeting,"is-create":c.value.isCreate,onSave:q,onClose:t[5]||(t[5]=n=>c.value.show=!1)},null,8,["show","meeting","is-create"]),i(o(st),{show:u.value.show,"onUpdate:show":t[7]||(t[7]=n=>u.value.show=n),title:"ç¡®è®¤åˆ é™¤",size:"sm"},{footer:l(()=>[i(o(k),{variant:"secondary",onClick:t[6]||(t[6]=n=>u.value.show=!1)},{default:l(()=>[...t[25]||(t[25]=[$(" å–æ¶ˆ ",-1)])]),_:1}),i(o(k),{variant:"danger",loading:u.value.loading,onClick:X},{default:l(()=>[...t[26]||(t[26]=[$(" åˆ é™¤ ",-1)])]),_:1},8,["loading"])]),default:l(()=>{var n;return[s("p",null,"ç¡®å®šè¦åˆ é™¤ä¾‹ä¼šã€Œ"+f((n=u.value.meeting)==null?void 0:n.title)+"ã€å—ï¼Ÿ",1),t[27]||(t[27]=s("p",{class:"warning-text"}," æ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚ ",-1))]}),_:1},8,["show"])])}}}),ge=at(ae,[["__scopeId","data-v-94d516e3"]]);export{ge as default};
//# sourceMappingURL=AdminMeetingManager-BRUjjUIV.js.map
