{"version":3,"file":"utils-BZMi4_q3.js","sources":["../../src/api/utils.ts"],"sourcesContent":["import type { PaginationInfo } from '@/types/entities'\r\n\r\nexport interface PaginationParams {\r\n  page?: number | string\r\n  size?: number | string\r\n}\r\n\r\nconst DEFAULT_SORT_STATE = {\r\n  empty: true,\r\n  sorted: false,\r\n  unsorted: true\r\n}\r\n\r\nexport type SortState = typeof DEFAULT_SORT_STATE\r\n\r\nconst buildPageableMeta = (page: number, size: number) => ({\r\n  pageNumber: page,\r\n  pageSize: size,\r\n  offset: page * size,\r\n  paged: true,\r\n  unpaged: false,\r\n  sort: DEFAULT_SORT_STATE\r\n})\r\n\r\nexport type QueryPrimitive = string | number | boolean\r\nexport type QueryValue = QueryPrimitive | QueryPrimitive[]\r\nexport type QueryParams = Record<string, QueryValue | undefined | null>\r\n\r\nexport interface PageResult<T> {\r\n  content: T[]\r\n  totalElements: number\r\n  totalPages: number\r\n  size: number\r\n  number: number\r\n  sort: SortState\r\n  first: boolean\r\n  last: boolean\r\n  numberOfElements: number\r\n  pageable: ReturnType<typeof buildPageableMeta>\r\n  empty: boolean\r\n}\r\n\r\nconst coerceNumber = (value: number | string | undefined, fallback: number) => {\r\n  if (typeof value === 'number') return value\r\n  if (typeof value === 'string') {\r\n    const parsed = parseInt(value, 10)\r\n    return Number.isNaN(parsed) ? fallback : parsed\r\n  }\r\n  return fallback\r\n}\r\n\r\nexport const createPagedResponse = <T>(items: T[], params?: PaginationParams): PageResult<T> => {\r\n  const page = Math.max(0, coerceNumber(params?.page, 0))\r\n  const size = Math.max(1, coerceNumber(params?.size, items.length || 10))\r\n  const start = page * size\r\n  const content = items.slice(start, start + size)\r\n  const totalElements = items.length\r\n  const totalPages = Math.max(1, Math.ceil(totalElements / size))\r\n\r\n  return {\r\n    content,\r\n    totalElements,\r\n    totalPages,\r\n    size,\r\n    number: page,\r\n    sort: DEFAULT_SORT_STATE,\r\n    first: page === 0,\r\n    last: page >= totalPages - 1,\r\n    numberOfElements: content.length,\r\n    pageable: buildPageableMeta(page, size),\r\n    empty: content.length === 0\r\n  }\r\n}\r\n\r\nexport const ensurePagedData = <T>(\r\n  data: unknown,\r\n  params?: PaginationParams,\r\n  fallbackItems: T[] = []\r\n): PageResult<T> => {\r\n  if (Array.isArray(data)) {\r\n    return createPagedResponse<T>(data, params)\r\n  }\r\n\r\n  if (data && typeof data === 'object' && 'content' in data) {\r\n    return data as PageResult<T>\r\n  }\r\n\r\n  return createPagedResponse<T>(fallbackItems, params)\r\n}\r\n\r\nexport const fallbackPaginationInfo = (result: PageResult<unknown>): PaginationInfo => ({\r\n  current: result.number + 1,\r\n  pageSize: result.size,\r\n  total: result.totalElements,\r\n  pages: result.totalPages\r\n})\r\n"],"names":["DEFAULT_SORT_STATE","buildPageableMeta","page","size","coerceNumber","value","fallback","parsed","createPagedResponse","items","params","start","content","totalElements","totalPages","ensurePagedData","data","fallbackItems"],"mappings":"AAOA,MAAMA,EAAqB,CACzB,MAAO,GACP,OAAQ,GACR,SAAU,EACZ,EAIMC,EAAoB,CAACC,EAAcC,KAAkB,CACzD,WAAYD,EACZ,SAAUC,EACV,OAAQD,EAAOC,EACf,MAAO,GACP,QAAS,GACT,KAAMH,CACR,GAoBMI,EAAe,CAACC,EAAoCC,IAAqB,CAC7E,GAAI,OAAOD,GAAU,SAAU,OAAOA,EACtC,GAAI,OAAOA,GAAU,SAAU,CAC7B,MAAME,EAAS,SAASF,EAAO,EAAE,EACjC,OAAO,OAAO,MAAME,CAAM,EAAID,EAAWC,CAC3C,CACA,OAAOD,CACT,EAEaE,EAAsB,CAAIC,EAAYC,IAA6C,CAC9F,MAAMR,EAAO,KAAK,IAAI,EAAGE,EAAaM,GAAA,YAAAA,EAAQ,KAAM,CAAC,CAAC,EAChDP,EAAO,KAAK,IAAI,EAAGC,EAAaM,GAAA,YAAAA,EAAQ,KAAMD,EAAM,QAAU,EAAE,CAAC,EACjEE,EAAQT,EAAOC,EACfS,EAAUH,EAAM,MAAME,EAAOA,EAAQR,CAAI,EACzCU,EAAgBJ,EAAM,OACtBK,EAAa,KAAK,IAAI,EAAG,KAAK,KAAKD,EAAgBV,CAAI,CAAC,EAE9D,MAAO,CACL,QAAAS,EACA,cAAAC,EACA,WAAAC,EACA,KAAAX,EACA,OAAQD,EACR,KAAMF,EACN,MAAOE,IAAS,EAChB,KAAMA,GAAQY,EAAa,EAC3B,iBAAkBF,EAAQ,OAC1B,SAAUX,EAAkBC,EAAMC,CAAI,EACtC,MAAOS,EAAQ,SAAW,CAAA,CAE9B,EAEaG,EAAkB,CAC7BC,EACAN,EACAO,EAAqB,CAAA,IAEjB,MAAM,QAAQD,CAAI,EACbR,EAAuBQ,EAAMN,CAAM,EAGxCM,GAAQ,OAAOA,GAAS,UAAY,YAAaA,EAC5CA,EAGFR,EAAuBS,EAAeP,CAAM"}