import{M as st,a as at,g as lt,d as nt,b as ot,c as Q,u as it}from"./MeetingDetailModal-DJiukhCu.js";import{a as rt,o as dt,B as m,L as ut,b as ct,r as vt,_ as ft}from"./index-BMWbWexx.js";import{B as b}from"./BaseCard-D1PUeRly.js";import{B as pt}from"./BasePagination-DEnt6_dI.js";import{_ as ht,a as gt}from"./ListIcon.vue_vue_type_script_setup_true_lang-CZxNQ0Ja.js";import{l as wt,r as _,a as I,j as D,k as _t,e as yt,C as v,E as s,z as n,B as r,N as k,u as i,K as h,F as P,Q as O,G as U,W as Ct,J as f}from"./vendor-vue-KPUYMlG2.js";import"./vendor-utils-B9ygI19o.js";const mt={class:"admin-meeting-manager"},bt={class:"manager-header"},kt={class:"header-actions"},Mt={class:"filter-section"},Dt={class:"stats-section"},zt={class:"stats-grid"},$t={class:"stat-content"},Bt={class:"stat-info"},St={class:"stat-number"},Rt={class:"stat-content"},Ft={class:"stat-info"},Vt={class:"stat-number"},Et={class:"stat-content"},xt={class:"stat-info"},At={class:"stat-number"},Lt={class:"stat-content"},Nt={class:"stat-info"},Qt={class:"stat-number"},It={class:"meetings-section"},Pt={class:"section-header"},Ot={class:"view-controls"},Ut={key:0,class:"loading-container"},Tt={key:1,class:"empty-state"},Wt={key:2},jt={key:0,class:"meetings-grid"},Gt={key:1,class:"meetings-list"},Ht={class:"meeting-list-content"},Jt={class:"meeting-main-info"},Kt={class:"meeting-meta"},qt={class:"meta-item"},Xt={class:"meta-item"},Yt={class:"meta-item"},Zt={class:"meeting-actions"},te=["onClick"],ee=["onClick"],se=["onClick"],ae=["onClick"],le={class:"pagination-section"},ne=wt({__name:"AdminMeetingManager",setup(oe){const $=t=>({searchQuery:(t==null?void 0:t.searchQuery)??"",statuses:(t==null?void 0:t.statuses)??[],types:(t==null?void 0:t.types)??[],attendeeSizes:(t==null?void 0:t.attendeeSizes)??[],tags:(t==null?void 0:t.tags)??[],dateRange:t!=null&&t.dateRange?{start:t.dateRange.start??"",end:t.dateRange.end??""}:void 0,sortBy:(t==null?void 0:t.sortBy)??"date",sortDirection:(t==null?void 0:t.sortDirection)??"desc"});rt({title:"ä¾‹ä¼šç®¡ç† - ç®¡ç†å‘˜åå°",meta:[{name:"description",content:"ç®¡ç†ä¾‹ä¼šè®°å½•ã€æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯"}]});const y=_([]),z=_(!1),C=_("grid"),l=_($()),d=_({current:1,pageSize:12,total:0}),T=()=>{var o,a,w,x,A,L,N;const t={page:d.value.current-1,size:d.value.pageSize},e=(o=l.value.searchQuery)==null?void 0:o.trim();return e&&(t.keyword=e),(a=l.value.statuses)!=null&&a.length&&(t.statuses=l.value.statuses),(w=l.value.types)!=null&&w.length&&(t.types=l.value.types),(x=l.value.attendeeSizes)!=null&&x.length&&(t.attendeeSizes=l.value.attendeeSizes),(A=l.value.tags)!=null&&A.length&&(t.tags=l.value.tags),(L=l.value.dateRange)!=null&&L.start&&(t.startDate=l.value.dateRange.start),(N=l.value.dateRange)!=null&&N.end&&(t.endDate=l.value.dateRange.end),l.value.sortBy&&(t.sortBy=l.value.sortBy),l.value.sortDirection&&(t.sortOrder=l.value.sortDirection),t},M=_({show:!1,meeting:null}),u=_({show:!1,meeting:null,isCreate:!1}),c=_({show:!1,meeting:null,loading:!1}),B=[],p=(t,e,o="success",a)=>{vt({entity:"meetings",action:t,message:e,targetId:a,result:o}).catch(w=>{console.warn("è®°å½•ä¾‹ä¼šæ“ä½œæ—¥å¿—å¤±è´¥:",w)})};I(()=>d.value.current,()=>{g()}),I(l,()=>{d.value.current=1,g()},{deep:!0});const W=D(()=>d.value.total),j=D(()=>{const t=new Date;return t.setDate(t.getDate()-7),y.value.filter(e=>new Date(e.date)>=t).length}),G=D(()=>y.value.reduce((t,e)=>t+e.attendees.length,0)),H=D(()=>y.value.reduce((t,e)=>{const o=e.actionItems??[];return t+o.filter(a=>a.status==="completed").length},0)),J=t=>new Date(t).toLocaleDateString("zh-CN"),g=async()=>{z.value=!0;try{const t=await lt(T());y.value=t.content,d.value.total=t.totalElements,d.value.pageSize=t.size,d.value.current=t.number+1}catch(t){console.error("åŠ è½½ä¾‹ä¼šæ•°æ®å¤±è´¥:",t)}finally{z.value=!1}},K=t=>{l.value=$(t)},q=t=>{d.value.current=t},S=()=>{u.value={show:!0,meeting:null,isCreate:!0}},R=t=>{M.value={show:!0,meeting:t}},X=t=>{var o;const e=(o=t.files)==null?void 0:o[0];e!=null&&e.url&&window.open(e.url,"_blank")},Y=t=>{t.recording&&window.open(t.recording,"_blank")},F=t=>{u.value={show:!0,meeting:{...t},isCreate:!1}},V=t=>{c.value={show:!0,meeting:t,loading:!1}},E=async t=>{try{const e={...t,id:void 0,title:`${t.title} (å‰¯æœ¬)`,date:new Date().toISOString().split("T")[0]},o=await Q(e);await g(),p("duplicate",`å¤åˆ¶ä¾‹ä¼šã€Œ${t.title}ã€`,"success",o.id)}catch(e){console.error("å¤åˆ¶ä¾‹ä¼šå¤±è´¥:",e),p("duplicate",`å¤åˆ¶ä¾‹ä¼šã€Œ${t.title}ã€å¤±è´¥`,"failure",t.id)}},Z=async t=>{try{if(u.value.isCreate){const e=await Q(t);p("create",`åˆ›å»ºä¾‹ä¼šã€Œ${e.title}ã€`,"success",e.id)}else{const e=await it(t.id,t);p("update",`æ›´æ–°ä¾‹ä¼šã€Œ${e.title}ã€`,"success",e.id)}await g(),u.value.show=!1}catch(e){console.error("ä¿å­˜ä¾‹ä¼šå¤±è´¥:",e);const o=u.value.isCreate?"create":"update";p(o,`ä¿å­˜ä¾‹ä¼šã€Œ${t.title}ã€å¤±è´¥`,"failure",t.id)}},tt=async()=>{const t=c.value.meeting;if(t){c.value.loading=!0;try{await nt(t.id),await g(),c.value.show=!1,p("delete",`åˆ é™¤ä¾‹ä¼šã€Œ${t.title}ã€`,"success",t.id)}catch(e){console.error("åˆ é™¤ä¾‹ä¼šå¤±è´¥:",e),p("delete",`åˆ é™¤ä¾‹ä¼šã€Œ${t.title}ã€å¤±è´¥`,"failure",t.id)}finally{c.value.loading=!1}}},et=()=>{g(),p("refresh","æ‰‹åŠ¨åˆ·æ–°ä¾‹ä¼šåˆ—è¡¨")};return _t(()=>{g();const t=dt(e=>{if(e.entity==="all"||e.entity==="meetings"){g();const o=e.action??"refresh";p("refresh",`å…¨å±€è§¦å‘ ${o} åŒæ­¥ä¾‹ä¼šæ•°æ®`)}});B.push(t)}),yt(()=>{B.forEach(t=>t())}),(t,e)=>{const o=Ct("MeetingEditModal");return f(),v("div",mt,[s("div",bt,[e[9]||(e[9]=s("h2",null,"ä¾‹ä¼šç®¡ç†",-1)),s("div",kt,[n(i(m),{variant:"primary",onClick:S},{default:r(()=>[...e[7]||(e[7]=[k(" + æ–°å»ºä¾‹ä¼š ",-1)])]),_:1}),n(i(m),{variant:"secondary",onClick:et},{default:r(()=>[...e[8]||(e[8]=[k(" åˆ·æ–° ",-1)])]),_:1})])]),s("div",Mt,[n(st,{"initial-filters":l.value,onFilterChange:K},null,8,["initial-filters"])]),s("div",Dt,[s("div",zt,[n(i(b),{class:"stat-card"},{default:r(()=>[s("div",$t,[e[11]||(e[11]=s("div",{class:"stat-icon meeting-icon"}," ğŸ“… ",-1)),s("div",Bt,[s("div",St,h(W.value),1),e[10]||(e[10]=s("div",{class:"stat-label"}," æ€»ä¾‹ä¼šæ•° ",-1))])])]),_:1}),n(i(b),{class:"stat-card"},{default:r(()=>[s("div",Rt,[e[13]||(e[13]=s("div",{class:"stat-icon recent-icon"}," ğŸ†• ",-1)),s("div",Ft,[s("div",Vt,h(j.value),1),e[12]||(e[12]=s("div",{class:"stat-label"}," æœ¬å‘¨ä¾‹ä¼š ",-1))])])]),_:1}),n(i(b),{class:"stat-card"},{default:r(()=>[s("div",Et,[e[15]||(e[15]=s("div",{class:"stat-icon participants-icon"}," ğŸ‘¥ ",-1)),s("div",xt,[s("div",At,h(G.value),1),e[14]||(e[14]=s("div",{class:"stat-label"}," å‚ä¸äººæ¬¡ ",-1))])])]),_:1}),n(i(b),{class:"stat-card"},{default:r(()=>[s("div",Lt,[e[17]||(e[17]=s("div",{class:"stat-icon action-icon"}," âœ… ",-1)),s("div",Nt,[s("div",Qt,h(H.value),1),e[16]||(e[16]=s("div",{class:"stat-label"}," å¾…åŠå®Œæˆ ",-1))])])]),_:1})])]),s("div",It,[n(i(b),{class:"content-card"},{header:r(()=>[s("div",Pt,[e[18]||(e[18]=s("h3",null,"ä¾‹ä¼šåˆ—è¡¨",-1)),s("div",Ot,[s("button",{class:U(["view-btn",{active:C.value==="grid"}]),onClick:e[0]||(e[0]=a=>C.value="grid")},[n(i(ht),{size:"16"})],2),s("button",{class:U(["view-btn",{active:C.value==="list"}]),onClick:e[1]||(e[1]=a=>C.value="list")},[n(i(gt),{size:"16"})],2)])])]),default:r(()=>[z.value?(f(),v("div",Ut,[n(i(ut)),e[19]||(e[19]=s("p",null,"åŠ è½½ä¾‹ä¼šæ•°æ®ä¸­...",-1))])):y.value.length===0?(f(),v("div",Tt,[e[21]||(e[21]=s("div",{class:"empty-icon"}," ğŸ“… ",-1)),e[22]||(e[22]=s("h3",null,"æš‚æ— ä¾‹ä¼šè®°å½•",-1)),e[23]||(e[23]=s("p",null,"æ‚¨è¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•ä¾‹ä¼šè®°å½•",-1)),n(i(m),{variant:"primary",onClick:S},{default:r(()=>[...e[20]||(e[20]=[k(" åˆ›å»ºç¬¬ä¸€ä¸ªä¾‹ä¼š ",-1)])]),_:1})])):(f(),v("div",Wt,[C.value==="grid"?(f(),v("div",jt,[(f(!0),v(P,null,O(y.value,a=>(f(),v("div",{key:a.id,class:"meeting-grid-item"},[n(ot,{meeting:a,"show-actions":!0,onView:R,onEdit:F,onDelete:V,onDuplicate:E},null,8,["meeting"])]))),128))])):(f(),v("div",Gt,[(f(!0),v(P,null,O(y.value,a=>(f(),v("div",{key:a.id,class:"meeting-list-item"},[s("div",Ht,[s("div",Jt,[s("h4",null,h(a.title),1),s("div",Kt,[s("span",qt," ğŸ“… "+h(J(a.date)),1),s("span",Xt," ğŸ• "+h(a.time),1),s("span",Yt," ğŸ‘¥ "+h(a.attendees.length)+" äººå‚ä¸ ",1)])]),s("div",Zt,[s("button",{class:"action-btn view-btn",title:"æŸ¥çœ‹è¯¦æƒ…",onClick:w=>R(a)}," ğŸ‘ï¸ ",8,te),s("button",{class:"action-btn edit-btn",title:"ç¼–è¾‘",onClick:w=>F(a)}," âœï¸ ",8,ee),s("button",{class:"action-btn duplicate-btn",title:"å¤åˆ¶",onClick:w=>E(a)}," ğŸ“‹ ",8,se),s("button",{class:"action-btn delete-btn",title:"åˆ é™¤",onClick:w=>V(a)}," ğŸ—‘ï¸ ",8,ae)])])]))),128))])),s("div",le,[n(i(pt),{current:d.value.current,"page-size":d.value.pageSize,total:d.value.total,onChange:q},null,8,["current","page-size","total"])])]))]),_:1})]),n(at,{meeting:M.value.meeting,"is-open":M.value.show,onClose:e[2]||(e[2]=a=>M.value.show=!1),onViewFiles:X,onViewRecording:Y},null,8,["meeting","is-open"]),n(o,{show:u.value.show,"onUpdate:show":e[3]||(e[3]=a=>u.value.show=a),meeting:u.value.meeting,"is-create":u.value.isCreate,onSave:Z,onClose:e[4]||(e[4]=a=>u.value.show=!1)},null,8,["show","meeting","is-create"]),n(i(ct),{show:c.value.show,"onUpdate:show":e[6]||(e[6]=a=>c.value.show=a),title:"ç¡®è®¤åˆ é™¤",size:"sm"},{footer:r(()=>[n(i(m),{variant:"secondary",onClick:e[5]||(e[5]=a=>c.value.show=!1)},{default:r(()=>[...e[24]||(e[24]=[k(" å–æ¶ˆ ",-1)])]),_:1}),n(i(m),{variant:"danger",loading:c.value.loading,onClick:tt},{default:r(()=>[...e[25]||(e[25]=[k(" åˆ é™¤ ",-1)])]),_:1},8,["loading"])]),default:r(()=>{var a;return[s("p",null,"ç¡®å®šè¦åˆ é™¤ä¾‹ä¼šã€Œ"+h((a=c.value.meeting)==null?void 0:a.title)+"ã€å—ï¼Ÿ",1),e[26]||(e[26]=s("p",{class:"warning-text"}," æ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚ ",-1))]}),_:1},8,["show"])])}}}),pe=ft(ne,[["__scopeId","data-v-c16b52cd"]]);export{pe as default};
//# sourceMappingURL=AdminMeetingManager-CnHdQ5V_.js.map
